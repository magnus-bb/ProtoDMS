{"dashboards":[{"id":"c7410a92-3aca-4818-bb80-9b11e20705ed","name":"custom panel","icon":"dashboard","note":null,"color":"#18222F"},{"id":"d6a95587-ffbb-4afb-8de6-53bc51a6ebb2","name":"dashboard from editor user","icon":"dashboard","note":null,"color":null}],"panels":[{"id":"9116d744-55af-411f-849c-92dadcbfd133","dashboard":"c7410a92-3aca-4818-bb80-9b11e20705ed","name":"Number of documents with titles","icon":"post_add","color":null,"show_header":true,"note":null,"type":"metric","position_x":21,"position_y":14,"width":20,"height":6,"options":{"collection":"documents","field":"title","function":"count"}},{"id":"d1a088f3-202f-4e7d-bd97-7e19a219b106","dashboard":"c7410a92-3aca-4818-bb80-9b11e20705ed","name":null,"icon":null,"color":null,"show_header":false,"note":null,"type":"label","position_x":15,"position_y":2,"width":27,"height":11,"options":{"text":"data here"}},{"id":"ead80aa2-f2d7-41ea-813c-c2a4cb247694","dashboard":"d6a95587-ffbb-4afb-8de6-53bc51a6ebb2","name":null,"icon":null,"color":null,"show_header":false,"note":null,"type":"label","position_x":9,"position_y":6,"width":32,"height":13,"options":{"text":"editor user panel"}}],"flows":[{"id":"b15c7d8d-c2fa-40e2-903b-4a6ad60a450d","name":"Notify subscribers","icon":"circle_notifications","color":"#3BCE8E","description":"When a document changes, send a notification to all of the document's subscribers","status":"active","trigger":"event","accountability":"all","options":{"type":"action","scope":["items.create","items.update"],"collections":["documents"]},"operation":"b696c141-8239-48e5-99ea-6d3d6c8e6f10"}],"operations":[{"id":"138c4932-ed18-49f4-953b-bd0bfeaae630","name":"Get action","key":"action","type":"exec","position_x":73,"position_y":1,"options":{"code":"module.exports = async function({ $trigger }) {\n    const event = $trigger.event.split('.')\n    \n\treturn event[event.length - 1]\n}"},"resolve":"f00a0df8-1e17-48b1-94b4-4edc9aa2b003","reject":null,"flow":"b15c7d8d-c2fa-40e2-903b-4a6ad60a450d"},{"id":"332e57b8-0089-484b-8057-3201e73adc51","name":"Read affected documents","key":"read_document","type":"item-read","position_x":30,"position_y":18,"options":{"permissions":"$full","collection":"documents","key":"{{ $last }}"},"resolve":"65751f6d-012f-48cb-9a80-a72f3b70091f","reject":null,"flow":"b15c7d8d-c2fa-40e2-903b-4a6ad60a450d"},{"id":"4fe8f93a-3ee4-4a70-98e6-cc64a60bca5f","name":"Get subscriber ids","key":"subscriber_ids","type":"exec","position_x":55,"position_y":1,"options":{"code":"module.exports = async function({ $last, $accountability }) {\n    if (Array.isArray($last)) {\n        // Get ids of the subscriber users (not just relation's id) and filter off accountable user (don't notify self)\n        return $last.map(d => d.directus_users_id).filter(id => id !== $accountability.user)\n    }\n    \n    if ($last.directus_users_id === $accountability.user) return []\n    \n    return [ $last.directus_users_id ]\n}"},"resolve":"138c4932-ed18-49f4-953b-bd0bfeaae630","reject":null,"flow":"b15c7d8d-c2fa-40e2-903b-4a6ad60a450d"},{"id":"65751f6d-012f-48cb-9a80-a72f3b70091f","name":"Read subscribers","key":"read_subscribers","type":"item-read","position_x":37,"position_y":1,"options":{"collection":"documents_directus_users","permissions":"$full","query":null,"key":"{{ $last.subscribers }}"},"resolve":"4fe8f93a-3ee4-4a70-98e6-cc64a60bca5f","reject":null,"flow":"b15c7d8d-c2fa-40e2-903b-4a6ad60a450d"},{"id":"b696c141-8239-48e5-99ea-6d3d6c8e6f10","name":"Get affected documents","key":"get_affected_documents","type":"exec","position_x":9,"position_y":18,"options":{"code":"module.exports = async function({ $trigger }) {\n    // If an update happens, the updated documents are in the $trigger.keys array\n    // If a create event happens, the created document is in the $trigger.key int\n    // Either way, we return an array of keys for the next step\n    return $trigger.keys || [ $trigger.key ]\n}"},"resolve":"332e57b8-0089-484b-8057-3201e73adc51","reject":null,"flow":"b15c7d8d-c2fa-40e2-903b-4a6ad60a450d"},{"id":"d366388d-a770-41dc-a980-0eb704979bb8","name":"Send Notification","key":"notification","type":"notification","position_x":97,"position_y":1,"options":{"subject":"'{{ read_document.title }}' was {{ action }}d","message":"{{ get_accountable_user.first_name }} {{ get_accountable_user.last_name }}","recipient":"{{ subscriber_ids }}","permissions":"$full"},"resolve":null,"reject":null,"flow":"b15c7d8d-c2fa-40e2-903b-4a6ad60a450d"},{"id":"f00a0df8-1e17-48b1-94b4-4edc9aa2b003","name":"Get accountable user","key":"get_accountable_user","type":"item-read","position_x":88,"position_y":19,"options":{"collection":"directus_users","key":"{{ $accountability.user }}"},"resolve":"d366388d-a770-41dc-a980-0eb704979bb8","reject":null,"flow":"b15c7d8d-c2fa-40e2-903b-4a6ad60a450d"}],"folders":[{"id":"14346af7-6228-460d-a199-18704a4d1e45","name":"Some files go here","parent":null},{"id":"178fc542-c6b6-4888-aa60-8b7c19504691","name":"Another name","parent":"4c126279-8e7a-4dce-be03-56fd6375bd38"},{"id":"4c126279-8e7a-4dce-be03-56fd6375bd38","name":"Inside other folders","parent":"14346af7-6228-460d-a199-18704a4d1e45"},{"id":"bec1220b-1666-46dd-83ce-beac39091387","name":"Some folders go","parent":"14346af7-6228-460d-a199-18704a4d1e45"}],"webhooks":[{"id":1,"name":"hooked","method":"GET","url":"/something","status":"active","data":true,"actions":["create"],"collections":["documents"],"headers":[{"header":"Authorization","value":"Bearer xyz"}]}],"roles":[{"id":"cfe8bdca-d05f-4c68-a35c-d78a7502e6f8","name":"Website","icon":"computer","description":"The website uses a static token to make sure documents are saved when users forget to do so","ip_access":null,"enforce_tfa":false,"admin_access":false,"app_access":false},{"id":"d4f86fff-edb4-4d71-b93a-b16ecb919841","name":"User","icon":"account_circle","description":null,"ip_access":null,"enforce_tfa":false,"admin_access":false,"app_access":false}],"permissions":[{"id":74,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_files","action":"read","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":76,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"documents","action":"read","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":77,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"documents","action":"create","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":78,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"documents","action":"update","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":79,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"documents","action":"delete","permissions":{"_and":[{"user_created":{"_eq":"$CURRENT_USER"}}]},"validation":null,"presets":null,"fields":null},{"id":83,"role":null,"collection":"directus_users","action":"create","permissions":null,"validation":{"_and":[{"role":{"_eq":"d4f86fff-edb4-4d71-b93a-b16ecb919841"}}]},"presets":{"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841"},"fields":["first_name","last_name","password","email","role"]},{"id":84,"role":null,"collection":"directus_users","action":"read","permissions":{},"validation":{},"presets":null,"fields":["id"]},{"id":85,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_notifications","action":"read","permissions":{"_and":[{"recipient":{"_eq":"$CURRENT_USER"}}]},"validation":null,"presets":null,"fields":["subject","message","collection","recipient","status","timestamp","id","item","sender"]},{"id":93,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_users","action":"read","permissions":{"_and":[{"id":{"_eq":"$CURRENT_USER"}}]},"validation":{},"presets":null,"fields":["*"]},{"id":94,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_notifications","action":"delete","permissions":{"_and":[{"recipient":{"_eq":"$CURRENT_USER"}}]},"validation":null,"presets":null,"fields":null},{"id":96,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_folders","action":"read","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":98,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_files","action":"create","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":99,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_files","action":"update","permissions":{"_and":[{"folder":{"_neq":"null"}}]},"validation":{},"presets":null,"fields":["*"]},{"id":100,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_files","action":"delete","permissions":{"_and":[{"folder":{"_neq":"null"}}]},"validation":{},"presets":null,"fields":["*"]},{"id":102,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_folders","action":"create","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":103,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_folders","action":"update","permissions":{},"validation":{"_and":[{"parent":{"_neq":"null"}}]},"presets":null,"fields":["*"]},{"id":104,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_folders","action":"delete","permissions":{"_and":[{"parent":{"_neq":"null"}}]},"validation":{},"presets":null,"fields":["*"]},{"id":106,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":"directus_collections","action":"read","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":112,"role":"cfe8bdca-d05f-4c68-a35c-d78a7502e6f8","collection":"documents","action":"read","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":113,"role":"cfe8bdca-d05f-4c68-a35c-d78a7502e6f8","collection":"documents","action":"update","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":114,"role":"cfe8bdca-d05f-4c68-a35c-d78a7502e6f8","collection":"documents_directus_users","action":"create","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":115,"role":"cfe8bdca-d05f-4c68-a35c-d78a7502e6f8","collection":"documents_directus_users","action":"read","permissions":{},"validation":{},"presets":null,"fields":["*"]},{"id":116,"role":"cfe8bdca-d05f-4c68-a35c-d78a7502e6f8","collection":"documents_directus_users","action":"update","permissions":{},"validation":{},"presets":null,"fields":["*"]}],"presets":[{"id":6,"bookmark":null,"user":null,"role":"d4f86fff-edb4-4d71-b93a-b16ecb919841","collection":null,"search":null,"layout":"calendar","layout_query":null,"layout_options":null,"refresh_interval":null,"filter":null,"icon":"add_task","color":null},{"id":7,"bookmark":null,"user":null,"role":null,"collection":"directus_files","search":null,"layout":"cards","layout_query":{"cards":{"sort":["-uploaded_on"],"page":1}},"layout_options":{"cards":{"icon":"insert_drive_file","title":"{{ title }}","subtitle":"{{ type }} â€¢ {{ filesize }}","size":4,"imageFit":"crop"}},"refresh_interval":null,"filter":null,"icon":"bookmark_outline","color":null}]}